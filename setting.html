<fieldset id="BeamAccount">
	<legend>Beam アカウント</legend>
	<p id="UserName">
		<input id="UserNameInput" type="text" placeholder="ユーザー名">
	</p>
	<p id="Password">
		<input id="PasswordInput" type="password" placeholder="パスワード">
	</p>
</fieldset>
<fieldset id="Whisper">
	<legend>Whisper の扱い</legend>
	<p id="PutWhisper">
		<input id="PutWhisperCheckbox" type="checkbox">
		<label for="PutWhisperCheckbox">Whisper を表示する<label>
	</p>
	<p id="CallWhisper">
		<input id="CallWhisperCheckbox" type="checkbox">
		<label for="CallWhisperCheckbox" class="checkbox">Whisper を読み上げる</label>
	</p>
</fieldset>
<fieldset id="BouyomiChan">
	<legend>棒読みちゃん連携</legend>
	<p id="CallBouyomiChan">
		<input id="CallBouyomiChanCheckbox" type="checkbox">
		<label for="CallBouyomiChanCheckbox">棒読みちゃん連携を有効にする<label>
	</p>
	<p id="BouyomiChanLocation">
		<input id="BouyomiChanLocationFile" type="file" accept=".exe" />
		<input id="BouyomiChanLocationInput" type="text" readonly placeholder="棒読みちゃんの場所 (クリックで設定する)">
	</p>
	<fieldset id="CallUserNameRadio">
	<legend>ユーザー名の読み上げ</legend>
	<p id="CallUserNameOff">
		<input name="CallUserNameRadio" id="CallUserNameOffRadio" type="radio" value="0">
		<label for="CallUserNameOffRadio">ユーザー名を読み上げない<label>
	</p>
	<p id="CallUserNameBefore">
		<input name="CallUserNameRadio" id="CallUserNameBeforeRadio" type="radio" value="1">
		<label for="CallUserNameBeforeRadio">コメントの前に読み上げる<label>
	</p>
	<p id="CallUserNameAfter">
		<input name="CallUserNameRadio" id="CallUserNameAfterRadio" type="radio" value="2">
		<label for="CallUserNameAfterRadio">コメントの後に読み上げる<label>
	</p>
	</fieldset>
</fieldset>

<div id="CloseButtons">
	<span id="OKButton">OK</span>
	<span id="CancelButton">キャンセル</span>
</div>

<!-- 以下 JavaScript -->
<script>
	(function ()
	{
		// 各項目の状態を設定と同期する
		$('#UserNameInput')					.val(Setting.UserName);
		$('#PasswordInput')					.val(Setting.Password);
		$('#PutWhisperCheckbox')			.prop('checked', Setting.PutWhisper);
		$('#CallWhisperCheckbox')			.prop('checked', Setting.CallWhisper);
		$('#CallBouyomiChanCheckbox')		.prop('checked', Setting.CallBouyomiChan);
		$('#BouyomiChanLocationInput')		.val(Setting.BouyomiChanLocation);
		$('[name=CallUserNameRadio]')		.val([Setting.CallUserName]);

		// OK ボタンが押された
		$('#OKButton').click(function()
		{
			Setting.UserName				= $('#UserNameInput').val();
			Setting.Password				= $('#PasswordInput').val();
			Setting.PutWhisper				= $('#PutWhisperCheckbox').prop('checked');
			Setting.CallWhisper				= $('#CallWhisperCheckbox').prop('checked');
			Setting.CallBouyomiChan			= $('#CallBouyomiChanCheckbox').prop('checked');
			Setting.BouyomiChanLocation		= $('#BouyomiChanLocationInput').val();
			Setting.CallUserName			= $('[name=CallUserNameRadio]:checked').val();

			// メニューバーを更新
			MenuBar.CheckboxUpdate();

			// 設定画面を閉じる
			Setting.Close();
		});

		// 棒読みちゃんの設定ボタンがクリックされた
		$('#BouyomiChanLocationInput').click(function()
		{
			$('#BouyomiChanLocationFile').click();
		});

		// 棒読みちゃんのパスが設定された
		$('#BouyomiChanLocationFile').change(function()
		{
			const fs = require('fs-extra');

			// 指定したファイルのディレクトリを取得
			var FilePath = $('#BouyomiChanLocationFile').val();

			// ファイルが選択された場合のみ
			if( FilePath != '')
			{
				var FileDir = Common.FullPath2Dir(FilePath);

				// 指定したディレクトリに RemoteTalk があるか調べる
				var RemoteTalkExists = FileDir+'\\'+Setting.RemoteTalkRelativePath
				fs.exists(RemoteTalkExists, function(exists)
				{
					if( exists )
					{
						$('#BouyomiChanLocationInput').val(FilePath);
					}
					else
					{
						alert('棒読みちゃんのフォルダ内に RemoteTalk が見つかりませんでした。\nBouyomiChan.exe が選択されていないか、ファイルが不足しています。');
					}
				});
			}
		});

		// キャンセルボタンが押された
		$('#CancelButton').click(function()
		{
			Setting.Close();
		});
	})();
</script>